<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Quiz SVT - 50 Questions</title>
        <style>
            /* ----------------------------------------------------
           ANIMATIONS (KEYFRAMES)
           ---------------------------------------------------- */
            @keyframes slideIn {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes slideOut {
                from {
                    opacity: 1;
                    transform: translateY(0);
                }
                to {
                    opacity: 0;
                    transform: translateY(-10px);
                }
            }

            /* NOUVEAU: Animation pour l'entrée du titre */
            @keyframes headerDrop {
                from {
                    opacity: 0;
                    transform: translateY(-50px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                    box-shadow: 0 5px 15px rgba(76, 81, 191, 0.3);
                }
                50% {
                    transform: scale(1.02);
                    box-shadow: 0 8px 20px rgba(76, 81, 191, 0.5);
                }
                100% {
                    transform: scale(1);
                    box-shadow: 0 5px 15px rgba(76, 81, 191, 0.3);
                }
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                }
                to {
                    opacity: 1;
                }
            }

            @keyframes resultsEntry {
                from {
                    opacity: 0;
                    transform: translateY(50px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* NOUVEAU: Animation pour une bonne réponse */
            @keyframes bounce {
                0%,
                20%,
                50%,
                80%,
                100% {
                    transform: translateY(0);
                }
                40% {
                    transform: translateY(-5px);
                }
                60% {
                    transform: translateY(-3px);
                }
            }

            /* NOUVEAU: Animation pour une mauvaise réponse */
            @keyframes shake {
                0%,
                100% {
                    transform: translateX(0);
                }
                20%,
                60% {
                    transform: translateX(-5px);
                }
                40%,
                80% {
                    transform: translateX(5px);
                }
            }

            /* NOUVEAU: Animation de lueur pour les résultats */
            @keyframes glowCorrect {
                0% {
                    box-shadow: 0 0 5px #68d391;
                }
                50% {
                    box-shadow: 0 0 20px #48bb78;
                }
                100% {
                    box-shadow: 0 0 5px #68d391;
                }
            }

            /* NOUVEAU: Animation pour faire "pop" le feedback textuel */
            @keyframes zoomFeedback {
                0% {
                    transform: scale(0.9);
                    opacity: 0;
                }
                100% {
                    transform: scale(1);
                    opacity: 1;
                }
            }

            /* ----------------------------------------------------
           STYLE GÉNÉRAL (100% LOCAL - PAS DE POLICE EXTERNE)
           ---------------------------------------------------- */
            body {
                font-family: Arial, Helvetica, sans-serif;
                background-color: #f0f4f8;
                padding: 1rem;
                line-height: 1.6;
                min-height: 100vh;
            }

            @media (min-width: 768px) {
                body {
                    padding: 2rem;
                }
            }

            /* ----------------------------------------------------
           CONTENEUR PRINCIPAL
           ---------------------------------------------------- */
            .quiz-container {
                max-width: 800px;
                margin: 2rem auto;
                padding: 2rem;
                background: #ffffff;
                border-radius: 20px;
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
            }

            /* ----------------------------------------------------
           HEADER
           ---------------------------------------------------- */
            .header {
                text-align: center;
                margin-bottom: 2rem;
            }

            .header h1 {
                font-size: 2rem;
                font-weight: 700;
                color: #1a202c;
                margin-bottom: 0.5rem;
                animation: headerDrop 0.8s ease-out; /* NOUVEAU: Animation au chargement */
            }

            .header p {
                color: #4a5568;
                font-size: 1.125rem;
                font-weight: 500;
            }

            /* ----------------------------------------------------
           CARTE DE QUESTION (CLASSES DE VITESSE AJOUTÉES)
           ---------------------------------------------------- */
            .question-card {
                min-height: 250px;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                border-radius: 15px;
                background-color: #f7faff;
                border: 2px solid #e2e8f0;
                transition:
                    opacity 0.3s ease,
                    transform 0.3s ease;
            }

            .question-card.entering {
                animation: slideIn 0.5s ease-out forwards;
            }

            /* Contrôle de vitesse basé sur la classe */
            .question-card.fast-exit {
                animation: slideOut 0.25s ease-in forwards; /* Rapide pour le succès */
            }
            .question-card.slow-exit {
                animation: slideOut 0.8s ease-in forwards; /* Lent pour l'échec */
            }

            .question-text {
                font-size: 1.3rem;
                font-weight: 700;
                margin-bottom: 1.5rem;
                color: #2d3748;
            }

            .options-container {
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
            }

            /* ----------------------------------------------------
           BOUTONS DE RÉPONSE
           ---------------------------------------------------- */
            .answer-btn {
                display: block;
                width: 100%;
                padding: 1rem 1.25rem;
                text-align: left;
                border-radius: 10px;
                transition: all 0.2s ease-out;
                font-weight: 600;
                border: 1px solid #c3dafe;
                color: #2b6cb0;
                background-color: #ebf4ff;
                cursor: pointer;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            }

            .answer-btn:hover:not(.selected):not(.correct):not(.incorrect) {
                background-color: #cee0f2;
                transform: translateY(-1px);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            }

            /* Sélection utilisateur */
            .selected {
                background-color: #3182ce;
                border-color: #2c5282;
                color: white;
                transform: scale(1.01);
                box-shadow: 0 5px 15px rgba(49, 130, 206, 0.4);
            }

            /* ----------------------------------------------------
           FEEDBACK COULEURS (AVEC ANIMATIONS)
           ---------------------------------------------------- */
            .correct {
                background-color: #48bb78 !important;
                border-color: #2f855a !important;
                color: white !important;
                box-shadow: 0 5px 15px rgba(72, 187, 120, 0.4);
                pointer-events: none;
                animation: bounce 0.6s ease-out; /* NOUVEAU: Animation pour la bonne réponse */
            }

            .incorrect {
                background-color: #f56565 !important;
                border-color: #c53030 !important;
                color: white !important;
                box-shadow: 0 5px 15px rgba(245, 101, 101, 0.4);
                pointer-events: none;
                animation: shake 0.5s ease-in-out; /* NOUVEAU: Animation pour la mauvaise réponse */
            }

            /* Feedback Area (Animation zoom/fade) */
            #feedback-area {
                margin-top: 1rem;
                padding: 1rem;
                border-radius: 10px;
                font-weight: 600;
                text-align: center;
                animation: zoomFeedback 0.4s
                    cubic-bezier(0.68, -0.55, 0.27, 1.55); /* NOUVEAU: Animation de feedback */
            }

            .feedback-correct {
                background-color: #e6fffa;
                color: #38a169;
                border: 1px solid #48bb78;
            }

            .feedback-incorrect {
                background-color: #fff5f5;
                color: #e53e3e;
                border: 1px solid #f56565;
            }

            /* ----------------------------------------------------
           BOUTON PRINCIPAL (AMÉLIORÉ ET ANIMÉ)
           ---------------------------------------------------- */
            .main-btn-container {
                margin-top: 2.5rem;
                display: flex;
                justify-content: center;
            }

            #main-btn {
                background-color: #4c51bf;
                color: white;
                padding: 1rem 2.5rem;
                border-radius: 12px;
                font-weight: 800;
                font-size: 1.1rem;
                transition:
                    background-color 0.3s,
                    transform 0.2s,
                    box-shadow 0.3s;
                width: 100%;
                border: none;
                cursor: pointer;
                box-shadow: 0 5px 15px rgba(76, 81, 191, 0.3);
            }

            @media (min-width: 768px) {
                #main-btn {
                    width: auto;
                }
            }

            #main-btn:hover:not(:disabled) {
                background-color: #3a4294;
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(76, 81, 191, 0.4);
            }

            #main-btn:active:not(:disabled) {
                animation: pulse 0.3s ease;
            }

            #main-btn:disabled {
                background-color: #a0aec0;
                cursor: not-allowed;
                box-shadow: none;
            }

            /* ----------------------------------------------------
           RÉSULTATS FINAUX (ANIMÉ ET GLOW)
           ---------------------------------------------------- */
            #results {
                margin-top: 2.5rem;
                padding: 2rem;
                background-color: #f0fff4;
                border: 2px solid #68d391;
                border-radius: 15px;
                text-align: center;
            }

            #results.entering {
                animation: resultsEntry 0.6s ease-out forwards;
            }

            /* NOUVEAU: Glow pour les résultats si le score est élevé */
            .high-score-glow {
                animation: glowCorrect 2s infinite alternate;
            }

            #results h2 {
                font-size: 1.8rem;
                font-weight: 700;
                color: #2f855a;
                margin-bottom: 1rem;
            }

            #score-display {
                font-size: 1.4rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                color: #38a169;
            }

            #feedback-message {
                font-size: 1.1rem;
                color: #4c51bf;
            }

            #results button {
                margin-top: 1.5rem;
                padding: 0.75rem 2rem;
                background-color: #48bb78;
                color: white;
                border-radius: 10px;
                font-weight: 700;
                transition: background-color 0.2s;
                border: none;
                cursor: pointer;
            }

            #results button:hover {
                background-color: #38a169;
            }

            /* Utility class */
            .hidden {
                display: none;
            }
        </style>
    </head>
    <body>
        <div class="quiz-container">
            <header class="header">
                <h1>Quiz SVT : 50 Questions</h1>
                <p>
                    Question <span id="current-q-number">1</span> /
                    <span id="total-q-number">50</span>
                </p>
            </header>

            <div id="quiz-area">
                <!-- La question actuelle sera rendue ici -->
                <div id="current-question-card" class="question-card">
                    <!-- Contenu dynamique -->
                </div>

                <div id="feedback-area" class="hidden"></div>

                <div class="main-btn-container">
                    <button id="main-btn" onclick="checkAnswerAndProceed()">
                        Valider la Réponse
                    </button>
                </div>
            </div>

            <div id="results" class="hidden">
                <h2>Quiz Terminé !</h2>
                <p id="score-display"></p>
                <p id="feedback-message"></p>
                <button onclick="restartQuiz()">Recommencer le Quiz</button>
            </div>
        </div>

        <script>
            // --- DATA: 50 Questions basées sur la Fiche de Révision ---
            const questions = [
                // I. Localisation et Organisation (15 Q)
                {
                    q: "L'ADN dans une cellule au repos est :",
                    answers: ["Déroulé", "Condensé", "Absent", "Fragmenté"],
                    correct: "Déroulé",
                },
                {
                    q: "Quel élément devient visible en forme de bâtonnet lors de la division cellulaire ?",
                    answers: ["Noyau", "Gène", "Chromosome", "Allèle"],
                    correct: "Chromosome",
                },
                {
                    q: "L'ADN est l'acronyme de :",
                    answers: [
                        "Acide Ribo... Nucléique",
                        "Acide Désoxyribonucléique",
                        "Acide Aminé",
                        "Acide Alpha...",
                    ],
                    correct: "Acide Désoxyribonucléique",
                },
                {
                    q: "Le compartiment cellulaire qui commande la mise en place des caractères est :",
                    answers: [
                        "Le Cytoplasme",
                        "La Mitochondrie",
                        "Le Noyau",
                        "Le Ribosome",
                    ],
                    correct: "Le Noyau",
                },
                {
                    q: "Un chromosome porte :",
                    answers: [
                        "Un seul gène",
                        "Plusieurs gènes",
                        "Une seule base azotée",
                        "Un seul allèle",
                    ],
                    correct: "Plusieurs gènes",
                },
                {
                    q: "La substance qui se condense pour former un chromosome est :",
                    answers: ["Protéine", "Acide aminé", "ADN", "Lipide"],
                    correct: "ADN",
                },
                {
                    q: "Comment se nomment les fragments d'ADN qui déterminent les caractères héréditaires ?",
                    answers: [
                        "Chromatides",
                        "Gènes",
                        "Centromères",
                        "Cytoplasmes",
                    ],
                    correct: "Gènes",
                },
                {
                    q: "Un chromosome à deux chromatides indique que la cellule a réalisé :",
                    answers: [
                        "La Mitose",
                        "La Phase G1",
                        "La Phase S (réplication de l'ADN)",
                        "La Méiose",
                    ],
                    correct: "La Phase S (réplication de l'ADN)",
                },
                {
                    q: "Dans une cellule somatique, l'information génétique pour un gène est :",
                    answers: [
                        "En une seule copie",
                        "En 23 copies",
                        "En deux copies (deux allèles)",
                        "Absente",
                    ],
                    correct: "En deux copies (deux allèles)",
                },
                {
                    q: "Un chromosome à un seul bâtonnet est dit :",
                    answers: [
                        "Dichromatidien",
                        "Monochromatidien",
                        "Triploïde",
                        "Diploïde",
                    ],
                    correct: "Monochromatidien",
                },
                {
                    q: "L'ADN déroulé dans le noyau est appelé :",
                    answers: [
                        "Protéine histone",
                        "Membrane",
                        "Sève",
                        "Chromatine",
                    ],
                    correct: "Chromatine",
                },
                {
                    q: "Vrai ou Faux : Un gène code toujours pour un seul et unique caractère.",
                    answers: ["Vrai", "Faux"],
                    correct: "Faux",
                },
                {
                    q: "La couleur d'une pelage est un exemple de :",
                    answers: [
                        "Gène",
                        "Chromosome",
                        "Caractère héréditaire",
                        "Allèle",
                    ],
                    correct: "Caractère héréditaire",
                },
                {
                    q: "Les chromosomes sont visibles uniquement :",
                    answers: [
                        "Pendant la phase de repos",
                        "Pendant la division cellulaire",
                        "Uniquement dans le cytoplasme",
                        "Toujours",
                    ],
                    correct: "Pendant la division cellulaire",
                },
                {
                    q: "Quelle est la définition d'un Allèle ?",
                    answers: [
                        "Un chromosome sexuel",
                        "La forme condensée de l'ADN",
                        "Une version d'un gène",
                        "L'ensemble des caractères observables",
                    ],
                    correct: "Une version d'un gène",
                },

                // II. Caryotype et Espèce (5 Q)
                {
                    q: "La représentation photographique ordonnée de l'ensemble des chromosomes est appelée :",
                    answers: ["Génome", "Phénotype", "Caryotype", "Génotype"],
                    correct: "Caryotype",
                },
                {
                    q: "Combien de paires de chromosomes y a-t-il dans une cellule somatique humaine ?",
                    answers: ["46", "22", "23", "44"],
                    correct: "23",
                },
                {
                    q: "Comment appelle-t-on la 23e paire de chromosomes chez l'Humain ?",
                    answers: [
                        "Paire autosomale",
                        "Paire somatique",
                        "Paire sexuelle",
                        "Paire unique",
                    ],
                    correct: "Paire sexuelle",
                },
                {
                    q: "Quel ensemble de chromosomes sexuels détermine le sexe féminin chez l'Humain ?",
                    answers: ["XY", "XX", "XO", "YY"],
                    correct: "XX",
                },
                {
                    q: "La présence d'un chromosome supplémentaire sur la paire 21 cause :",
                    answers: [
                        "Le Syndrome de Turner",
                        "La Trisomie 21",
                        "L'hémophilie",
                        "Le daltonisme",
                    ],
                    correct: "La Trisomie 21",
                },

                // III. Diversité, Phénotype et Génotype (10 Q)
                {
                    q: "L'ensemble des allèles d'un individu pour l'ensemble des gènes est son :",
                    answers: ["Phénotype", "Génotype", "Caryotype", "Génome"],
                    correct: "Génotype",
                },
                {
                    q: "Un allèle qui s'exprime s'il est présent en un seul exemplaire est dit :",
                    answers: ["Récessif", "Dominant", "Muté", "Hétérozygote"],
                    correct: "Dominant",
                },
                {
                    q: "Pour qu'un allèle récessif s'exprime, il doit être présent :",
                    answers: [
                        "En un seul exemplaire",
                        "En deux exemplaires",
                        "Jamais",
                        "Uniquement s'il y a mutation",
                    ],
                    correct: "En deux exemplaires",
                },
                {
                    q: "La modification de la séquence de l'ADN est un phénomène appelé :",
                    answers: [
                        "Fécondation",
                        "Mitose",
                        "Séquençage",
                        "Mutation",
                    ],
                    correct: "Mutation",
                },
                {
                    q: "Quelle est la conséquence principale d'une mutation ?",
                    answers: [
                        "Elle détruit toujours le chromosome",
                        "Elle crée un nouvel allèle",
                        "Elle double la quantité d'ADN",
                        "Elle provoque systématiquement une maladie",
                    ],
                    correct: "Elle crée un nouvel allèle",
                },
                {
                    q: "Une mutation est transmissible à la descendance uniquement si elle affecte :",
                    answers: [
                        "Une cellule somatique",
                        "Une cellule nerveuse",
                        "Une cellule reproductrice (gamète)",
                        "Le cytoplasme",
                    ],
                    correct: "Une cellule reproductrice (gamète)",
                },
                {
                    q: "Si le génotype est composé d'un allèle dominant et d'un allèle récessif, quel allèle détermine le phénotype ?",
                    answers: [
                        "Le récessif",
                        "Le dominant",
                        "Les deux à la fois",
                        "Aucun",
                    ],
                    correct: "Le dominant",
                },
                {
                    q: "Le génotype détermine :",
                    answers: [
                        "Le Noyau",
                        "Le Cytoplasme",
                        "Le Phénotype",
                        "L'Organite",
                    ],
                    correct: "Le Phénotype",
                },
                {
                    q: "La différence entre le phénotype et le génotype est que le phénotype est :",
                    answers: [
                        "Héréditaire",
                        "Observable",
                        "Toujours récessif",
                        "Situé dans le noyau",
                    ],
                    correct: "Observable",
                },
                {
                    q: "Les deux allèles d'un gène interagissent selon une relation de :",
                    answers: [
                        "Symbiose",
                        "Universalité",
                        "Dominance",
                        "Réplication",
                    ],
                    correct: "Dominance",
                },

                // IV. Mitose et Stabilité (5 Q)
                {
                    q: "Quel est le rôle principal de la mitose chez un organisme ?",
                    answers: [
                        "Créer la diversité génétique",
                        "Créer les gamètes",
                        "Assurer la croissance et le renouvellement des cellules",
                        "Réduire le nombre de chromosomes",
                    ],
                    correct:
                        "Assurer la croissance et le renouvellement des cellules",
                },
                {
                    q: "Quel est le résultat de la mitose en termes de cellules-filles ?",
                    answers: [
                        "Quatre cellules-filles différentes",
                        "Deux cellules-filles identiques",
                        "Une cellule-fille unique",
                        "Trois cellules-filles",
                    ],
                    correct: "Deux cellules-filles identiques",
                },
                {
                    q: "Dans la mitose, la phase de préparation inclut le doublement de :",
                    answers: [
                        "Le nombre de chromosomes",
                        "La quantité d'ADN",
                        "Le nombre de noyaux",
                        "Le nombre de cellules",
                    ],
                    correct: "La quantité d'ADN",
                },
                {
                    q: "Toutes les cellules somatiques d'un individu possèdent :",
                    answers: [
                        "Un caryotype différent",
                        "Le même caryotype",
                        "La moitié du caryotype",
                        "Un seul chromosome",
                    ],
                    correct: "Le même caryotype",
                },
                {
                    q: "La mitose est le mécanisme qui assure :",
                    answers: [
                        "La variabilité génétique",
                        "L'adaptation à l'environnement",
                        "Le maintien du caryotype et la stabilité génétique",
                        "La réduction du nombre de chromosomes",
                    ],
                    correct:
                        "Le maintien du caryotype et la stabilité génétique",
                },

                // V. Méiose et Fécondation (10 Q)
                {
                    q: "La méiose est la division cellulaire qui produit :",
                    answers: [
                        "Les cellules somatiques",
                        "Les cellules nerveuses",
                        "Les gamètes",
                        "Les cellules cancéreuses",
                    ],
                    correct: "Les gamètes",
                },
                {
                    q: "Le nombre de gamètes produits à partir d'une cellule initiale par méiose est de :",
                    answers: ["1", "2", "4", "8"],
                    correct: "4",
                },
                {
                    q: "Le résultat de la méiose est que les gamètes contiennent :",
                    answers: [
                        "Le même nombre de chromosomes que la cellule mère",
                        "Le double de chromosomes",
                        "La moitié du nombre de chromosomes de l'espèce",
                        "Un seul allèle",
                    ],
                    correct: "La moitié du nombre de chromosomes de l'espèce",
                },
                {
                    q: "Quel événement correspond à la 'première loterie génétique' créant 8 millions de possibilités ?",
                    answers: [
                        "La fusion des gamètes",
                        "Le brassage génétique de la méiose",
                        "Le doublement de l'ADN",
                        "La croissance",
                    ],
                    correct: "Le brassage génétique de la méiose",
                },
                {
                    q: "La Fécondation est la fusion de :",
                    answers: [
                        "Deux cellules somatiques",
                        "D'un gamète mâle et d'un gamète femelle",
                        "De deux noyaux somatiques",
                        "De deux chromosomes",
                    ],
                    correct: "D'un gamète mâle et d'un gamète femelle",
                },
                {
                    q: "La cellule formée par la fécondation est appelée :",
                    answers: [
                        "Gamète",
                        "Cellule-mère",
                        "Cellule-œuf",
                        "Cellule somatique",
                    ],
                    correct: "Cellule-œuf",
                },
                {
                    q: "La cellule-œuf retrouve le nombre de chromosomes de l'espèce (23 paires) grâce à :",
                    answers: [
                        "La mitose",
                        "La méiose",
                        "La fécondation",
                        "La mutation",
                    ],
                    correct: "La fécondation",
                },
                {
                    q: "Le mécanisme de la Fécondation est la 'deuxième loterie génétique' car :",
                    answers: [
                        "Il y a recombinaison",
                        "Il réunit au hasard deux gamètes",
                        "Il réduit le nombre de chromosomes",
                        "Il crée des mutations",
                    ],
                    correct: "Il réunit au hasard deux gamètes",
                },
                {
                    q: "Quel outil permet de visualiser toutes les combinaisons génétiques possibles pour la descendance ?",
                    answers: [
                        "Arbre généalogique",
                        "Échiquier de croisement",
                        "Caryotype",
                        "Électrophorèse",
                    ],
                    correct: "Échiquier de croisement",
                },
                {
                    q: "La diversité génétique des individus est principalement le résultat de :",
                    answers: [
                        "La mitose et la mutation",
                        "La méiose et la fécondation",
                        "La croissance cellulaire",
                        "La condensation des chromosomes",
                    ],
                    correct: "La méiose et la fécondation",
                },

                // VI. Transgénèse et Universalité (5 Q)
                {
                    q: "Quel est le principe de base de la transgénèse ?",
                    answers: [
                        "La modification du caryotype",
                        "Le transfert d'un gène d'un organisme à un autre",
                        "L'étude des fossiles",
                        "La destruction de l'ADN",
                    ],
                    correct: "Le transfert d'un gène d'un organisme à un autre",
                },
                {
                    q: "La transgénèse permet à l'organisme receveur :",
                    answers: [
                        "De perdre tous ses gènes",
                        "D'acquérir un nouveau caractère",
                        "De subir la méiose",
                        "De devenir stérile",
                    ],
                    correct: "D'acquérir un nouveau caractère",
                },
                {
                    q: "La production d'insuline humaine par des bactéries est un exemple d':",
                    answers: [
                        "Évolution",
                        "Transgénèse",
                        "Fécondation in vitro",
                        "Mitose",
                    ],
                    correct: "Transgénèse",
                },
                {
                    q: "Que confirme le succès de la transgénèse entre espèces différentes ?",
                    answers: [
                        "Que l'ADN est propre à chaque espèce",
                        "Que l'ADN est universel",
                        "Qu'il n'est pas transmissible",
                        "Qu'il est formé d'ARN",
                    ],
                    correct: "Que l'ADN est universel",
                },
                {
                    q: "Dans la transgénèse, l'organisme qui reçoit le fragment d'ADN est appelé :",
                    answers: ["Donneur", "Receveur", "Vecteur", "Enzyme"],
                    correct: "Receveur",
                },
            ];

            // --- GESTION DE L'ÉTAT DU QUIZ ---
            let currentQuestionIndex = 0;
            let score = 0;
            let userSelection = null;
            let questionsShuffled = [];
            let quizInProgress = false;

            // Fonction pour mélanger un tableau (Algorithme de Fisher-Yates)
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // Affiche la question actuelle
            function renderQuestion() {
                if (currentQuestionIndex >= questionsShuffled.length) {
                    showResults();
                    return;
                }

                const q = questionsShuffled[currentQuestionIndex];
                const card = document.getElementById("current-question-card");
                const questionNumber = currentQuestionIndex + 1;

                // 1. Réinitialise la carte et déclenche l'animation d'entrée
                card.classList.remove("slow-exit", "fast-exit");
                card.classList.add("entering");

                // Mise à jour de l'UI
                document.getElementById("current-q-number").textContent =
                    questionNumber;
                document.getElementById("total-q-number").textContent =
                    questionsShuffled.length;
                document.getElementById("main-btn").textContent =
                    "Valider la Réponse";
                document.getElementById("main-btn").disabled = true;

                card.innerHTML = `
                <p class="question-text">${q.q}</p>
                <div id="options-container" class="options-container">
                    <!-- Options de réponse -->
                </div>
            `;

                // Réinitialiser le feedback et la sélection
                document
                    .getElementById("feedback-area")
                    .classList.add("hidden");
                document
                    .getElementById("feedback-area")
                    .classList.remove("feedback-correct", "feedback-incorrect");
                userSelection = null;
                quizInProgress = true;

                const optionsContainer =
                    card.querySelector("#options-container");
                const shuffledAnswers = shuffle([...q.answers]);

                shuffledAnswers.forEach((answer) => {
                    const button = document.createElement("button");
                    button.type = "button";
                    button.className = "answer-btn";
                    button.setAttribute("data-answer", answer);
                    button.textContent = answer;
                    button.onclick = function () {
                        selectAnswer(answer, button);
                    };
                    optionsContainer.appendChild(button);
                });

                // Assure que l'animation d'entrée se rejoue lors de la prochaine question
                setTimeout(() => {
                    card.classList.remove("entering");
                }, 500);
            }

            // Gère la sélection de l'utilisateur
            function selectAnswer(answer, clickedButton) {
                if (!quizInProgress) return;

                const optionsContainer =
                    document.getElementById("options-container");
                // Désélectionner tous les boutons
                optionsContainer
                    .querySelectorAll(".answer-btn")
                    .forEach((btn) => {
                        btn.classList.remove("selected");
                    });

                // Sélectionner le bouton cliqué
                clickedButton.classList.add("selected");

                userSelection = answer;
                document.getElementById("main-btn").disabled = false; // Active le bouton Valider
            }

            // Vérifie la réponse, donne du feedback, puis passe à la question suivante
            function checkAnswerAndProceed() {
                if (userSelection === null || !quizInProgress) return;

                quizInProgress = false;
                document.getElementById("main-btn").disabled = true;

                const q = questionsShuffled[currentQuestionIndex];
                const isCorrect = userSelection === q.correct;
                const feedbackArea = document.getElementById("feedback-area");
                const optionsContainer =
                    document.getElementById("options-container");
                const card = document.getElementById("current-question-card");

                feedbackArea.classList.remove("hidden");

                // 1. Appliquer le feedback visuel aux boutons
                optionsContainer
                    .querySelectorAll(".answer-btn")
                    .forEach((btn) => {
                        const answer = btn.getAttribute("data-answer");
                        btn.classList.remove("selected");

                        if (answer === q.correct) {
                            btn.classList.add("correct");
                        } else if (answer === userSelection && !isCorrect) {
                            btn.classList.add("incorrect");
                        }
                    });

                // 2. Afficher le feedback textuel
                feedbackArea.classList.remove(
                    "feedback-correct",
                    "feedback-incorrect",
                );

                if (isCorrect) {
                    score++;
                    feedbackArea.textContent =
                        "Bravo ! Réponse correcte. Prochaine question rapidement !";
                    feedbackArea.classList.add("feedback-correct");
                    card.classList.add("fast-exit"); // Vitesse rapide
                } else {
                    feedbackArea.textContent = `Faux. La bonne réponse était : ${q.correct}. Prenez le temps de réfléchir.`;
                    feedbackArea.classList.add("feedback-incorrect");
                    card.classList.add("slow-exit"); // Vitesse lente
                }

                // 3. Déterminer la durée du délai de transition
                const delayDuration = isCorrect ? 500 : 3000; // 1.5s pour Correct, 3s pour Incorrect

                // 4. Préparer le bouton pour la prochaine action (désactivé pendant la transition)
                document.getElementById("main-btn").textContent =
                    "Question Suivante";

                // 5. Passer à la question suivante après le délai adapté
                setTimeout(() => {
                    currentQuestionIndex++;

                    // Si c'est la fin du quiz
                    if (currentQuestionIndex >= questionsShuffled.length) {
                        document.getElementById("main-btn").textContent =
                            "Voir les Résultats";
                        document.getElementById("main-btn").onclick =
                            showResults;
                        document.getElementById("main-btn").disabled = false;
                    } else {
                        renderQuestion();
                        document.getElementById("main-btn").onclick =
                            checkAnswerAndProceed;
                    }
                }, delayDuration);
            }

            // Affiche les résultats finaux
            function showResults() {
                document.getElementById("quiz-area").classList.add("hidden");
                const resultsDiv = document.getElementById("results");
                const totalQuestions = questionsShuffled.length;
                const percentage = Math.round((score / totalQuestions) * 100);

                document.getElementById("score-display").textContent =
                    `Votre score final est de ${score} / ${totalQuestions} (${percentage}%)`;

                let feedbackMsg = "";
                resultsDiv.classList.remove("high-score-glow"); // Réinitialiser le glow

                if (percentage === 100) {
                    feedbackMsg =
                        "Félicitations ! Maîtrise parfaite de la génétique. Vous êtes prêt(e) !";
                    resultsDiv.classList.add("high-score-glow"); // Appliquer le glow
                } else if (percentage >= 80) {
                    feedbackMsg =
                        "Excellent travail ! Vous avez une très bonne compréhension des notions.";
                    resultsDiv.classList.add("high-score-glow");
                } else if (percentage >= 60) {
                    feedbackMsg =
                        "Bon effort ! Revoyez les thèmes où vous avez eu le plus d'erreurs.";
                } else {
                    feedbackMsg =
                        "N'abandonnez pas. Reprenez les sections I, III et V de votre fiche pour consolider les bases.";
                }
                document.getElementById("feedback-message").textContent =
                    feedbackMsg;
                resultsDiv.classList.remove("hidden");

                // Déclenche l'animation d'entrée des résultats
                resultsDiv.classList.add("entering");

                // Scroll vers les résultats
                setTimeout(() => {
                    resultsDiv.scrollIntoView({ behavior: "smooth" });
                }, 100);
            }

            // Redémarre le quiz
            function restartQuiz() {
                currentQuestionIndex = 0;
                score = 0;
                userSelection = null;
                questionsShuffled = shuffle([...questions]);
                document.getElementById("quiz-area").classList.remove("hidden");

                const resultsDiv = document.getElementById("results");
                resultsDiv.classList.add("hidden");
                resultsDiv.classList.remove("entering", "high-score-glow"); // Réinitialise l'animation et le glow

                document.getElementById("main-btn").onclick =
                    checkAnswerAndProceed;
                renderQuestion();
            }

            // Initialisation du quiz
            window.onload = function () {
                document.getElementById("total-q-number").textContent =
                    questions.length;
                questionsShuffled = shuffle([...questions]);
                renderQuestion();
            };
        </script>
    </body>
</html>
